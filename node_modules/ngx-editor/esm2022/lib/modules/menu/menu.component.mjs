import { Component, Input, } from '@angular/core';
import { NgxEditorError } from 'ngx-editor/utils';
import { MenuService } from './menu.service';
import * as i0 from "@angular/core";
import * as i1 from "./menu.service";
import * as i2 from "@angular/common";
import * as i3 from "./toggle-command/toggle-command.component";
import * as i4 from "./insert-command/insert-command.component";
import * as i5 from "./link/link.component";
import * as i6 from "./dropdown/dropdown.component";
import * as i7 from "./image/image.component";
import * as i8 from "./color-picker/color-picker.component";
export const DEFAULT_TOOLBAR = [
    ['bold', 'italic'],
    ['code', 'blockquote'],
    ['underline', 'strike'],
    ['ordered_list', 'bullet_list'],
    [{ heading: ['h1', 'h2', 'h3', 'h4', 'h5', 'h6'] }],
    ['link', 'image'],
    ['text_color', 'background_color'],
    ['align_left', 'align_center', 'align_right', 'align_justify'],
    ['format_clear'],
];
export const TOOLBAR_MINIMAL = [
    ['bold', 'italic'],
    [{ heading: ['h1', 'h2', 'h3', 'h4', 'h5', 'h6'] }],
    ['link', 'image'],
    ['text_color', 'background_color'],
];
export const TOOLBAR_FULL = [
    ['bold', 'italic'],
    ['code', 'blockquote'],
    ['underline', 'strike'],
    ['ordered_list', 'bullet_list'],
    [{ heading: ['h1', 'h2', 'h3', 'h4', 'h5', 'h6'] }],
    ['link', 'image'],
    ['text_color', 'background_color'],
    ['align_left', 'align_center', 'align_right', 'align_justify'],
    ['horizontal_rule', 'format_clear', 'indent', 'outdent'],
    ['superscript', 'subscript'],
    ['undo', 'redo'],
];
const DEFAULT_COLOR_PRESETS = [
    '#b60205',
    '#d93f0b',
    '#fbca04',
    '#0e8a16',
    '#006b75',
    '#1d76db',
    '#0052cc',
    '#5319e7',
    '#e99695',
    '#f9d0c4',
    '#fef2c0',
    '#c2e0c6',
    '#bfdadc',
    '#c5def5',
    '#bfd4f2',
    '#d4c5f9',
];
export class MenuComponent {
    menuService;
    toolbar = TOOLBAR_MINIMAL;
    colorPresets = DEFAULT_COLOR_PRESETS;
    disabled = false;
    editor;
    customMenuRef = null;
    dropdownPlacement = 'bottom';
    toggleCommands = [
        'bold',
        'italic',
        'underline',
        'strike',
        'code',
        'blockquote',
        'ordered_list',
        'bullet_list',
        'align_left',
        'align_center',
        'align_right',
        'align_justify',
        'superscript',
        'subscript',
    ];
    insertCommands = [
        'horizontal_rule',
        'format_clear',
        'indent',
        'outdent',
        'undo',
        'redo',
    ];
    iconContainerClass = ['NgxEditor__MenuItem', 'NgxEditor__MenuItem--IconContainer'];
    dropdownContainerClass = ['NgxEditor__Dropdown'];
    seperatorClass = ['NgxEditor__Seperator'];
    constructor(menuService) {
        this.menuService = menuService;
    }
    get presets() {
        const col = 8;
        const colors = [];
        this.colorPresets.forEach((color, index) => {
            const row = Math.floor(index / col);
            if (!colors[row]) {
                colors.push([]);
            }
            colors[row].push(color);
        });
        return colors;
    }
    trackByIndex(index) {
        return index;
    }
    isDropDown(item) {
        if (item?.heading) {
            return true;
        }
        return false;
    }
    getDropdownItems(item) {
        return item;
    }
    isLinkItem(item) {
        if (item === 'link') {
            return true;
        }
        // NOTE: it is not sufficient to check for a `link` property
        // as String.prototype.link is a valid (although deprecated) method
        return typeof item === 'object'
            && typeof item?.link === 'object';
    }
    isLinkWithOptions(item) {
        // NOTE: it is not sufficient to check for a `link` property
        // as String.prototype.link is a valid (although deprecated) method
        return typeof item === 'object'
            && typeof item?.link === 'object';
    }
    getLinkOptions(item) {
        return item?.link;
    }
    ngOnInit() {
        if (!this.editor) {
            throw new NgxEditorError('Required editor instance to initialize menu component');
        }
        this.menuService.editor = this.editor;
    }
    static ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.2", ngImport: i0, type: MenuComponent, deps: [{ token: i1.MenuService }], target: i0.ɵɵFactoryTarget.Component });
    static ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "18.2.2", type: MenuComponent, selector: "ngx-editor-menu", inputs: { toolbar: "toolbar", colorPresets: "colorPresets", disabled: "disabled", editor: "editor", customMenuRef: "customMenuRef", dropdownPlacement: "dropdownPlacement" }, providers: [MenuService], ngImport: i0, template: "<div\n  class=\"NgxEditor__MenuBar\"\n  [ngClass]=\"{ 'NgxEditor--Disabled': disabled, 'NgxEditor__MenuBar--Reverse': dropdownPlacement === 'top' }\"\n>\n  <ng-container *ngFor=\"let toolbarItem of toolbar; let lastToolbarItem = last; trackBy: trackByIndex\">\n    <ng-container *ngFor=\"let item of toolbarItem; let lastItem = last; trackBy: trackByIndex\">\n      <!-- toggle icons -->\n      <ngx-toggle-command [toolbarItem]=\"item\" [class]=\"iconContainerClass\" *ngIf=\"toggleCommands.includes(item)\">\n      </ngx-toggle-command>\n\n      <ngx-insert-command [toolbarItem]=\"item\" [class]=\"iconContainerClass\" *ngIf=\"insertCommands.includes(item)\">\n      </ngx-insert-command>\n\n      <!-- link -->\n      <ng-container *ngIf=\"isLinkItem(item)\">\n        <ngx-link [class]=\"iconContainerClass\" [options]=\"getLinkOptions(item)\"></ngx-link>\n      </ng-container>\n\n      <!-- image -->\n      <ngx-image [class]=\"iconContainerClass\" *ngIf=\"item === 'image'\"> </ngx-image>\n\n      <!-- dropdown -->\n      <ng-container *ngIf=\"isDropDown(item)\">\n        <ngx-dropdown\n          *ngFor=\"let dropdownItem of getDropdownItems(item) | keyvalue; trackBy: trackByIndex\"\n          [class]=\"dropdownContainerClass\"\n          [group]=\"dropdownItem.key\"\n          [items]=\"dropdownItem.value\"\n        >\n        </ngx-dropdown>\n      </ng-container>\n\n      <!-- text color picker -->\n      <ngx-color-picker\n        [class]=\"iconContainerClass\"\n        *ngIf=\"item === 'text_color'\"\n        type=\"text_color\"\n        [presets]=\"presets\"\n      >\n      </ngx-color-picker>\n      <!-- background color picker -->\n      <ngx-color-picker\n        [class]=\"iconContainerClass\"\n        *ngIf=\"item === 'background_color'\"\n        type=\"background_color\"\n        [presets]=\"presets\"\n      >\n      </ngx-color-picker>\n\n      <!-- seperator -->\n      <div [class]=\"seperatorClass\" *ngIf=\"lastItem && !lastToolbarItem\"></div>\n    </ng-container>\n  </ng-container>\n\n  <!-- custom menu -->\n  <ng-container *ngIf=\"customMenuRef\">\n    <ng-container [ngTemplateOutlet]=\"customMenuRef\"></ng-container>\n  </ng-container>\n</div>\n", styles: [""], dependencies: [{ kind: "directive", type: i2.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i2.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i2.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i2.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "component", type: i3.ToggleCommandComponent, selector: "ngx-toggle-command", inputs: ["toolbarItem"] }, { kind: "component", type: i4.InsertCommandComponent, selector: "ngx-insert-command", inputs: ["toolbarItem"] }, { kind: "component", type: i5.LinkComponent, selector: "ngx-link", inputs: ["options"] }, { kind: "component", type: i6.DropdownComponent, selector: "ngx-dropdown", inputs: ["group", "items"] }, { kind: "component", type: i7.ImageComponent, selector: "ngx-image" }, { kind: "component", type: i8.ColorPickerComponent, selector: "ngx-color-picker", inputs: ["presets", "type"] }, { kind: "pipe", type: i2.KeyValuePipe, name: "keyvalue" }] });
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.2", ngImport: i0, type: MenuComponent, decorators: [{
            type: Component,
            args: [{ selector: 'ngx-editor-menu', providers: [MenuService], template: "<div\n  class=\"NgxEditor__MenuBar\"\n  [ngClass]=\"{ 'NgxEditor--Disabled': disabled, 'NgxEditor__MenuBar--Reverse': dropdownPlacement === 'top' }\"\n>\n  <ng-container *ngFor=\"let toolbarItem of toolbar; let lastToolbarItem = last; trackBy: trackByIndex\">\n    <ng-container *ngFor=\"let item of toolbarItem; let lastItem = last; trackBy: trackByIndex\">\n      <!-- toggle icons -->\n      <ngx-toggle-command [toolbarItem]=\"item\" [class]=\"iconContainerClass\" *ngIf=\"toggleCommands.includes(item)\">\n      </ngx-toggle-command>\n\n      <ngx-insert-command [toolbarItem]=\"item\" [class]=\"iconContainerClass\" *ngIf=\"insertCommands.includes(item)\">\n      </ngx-insert-command>\n\n      <!-- link -->\n      <ng-container *ngIf=\"isLinkItem(item)\">\n        <ngx-link [class]=\"iconContainerClass\" [options]=\"getLinkOptions(item)\"></ngx-link>\n      </ng-container>\n\n      <!-- image -->\n      <ngx-image [class]=\"iconContainerClass\" *ngIf=\"item === 'image'\"> </ngx-image>\n\n      <!-- dropdown -->\n      <ng-container *ngIf=\"isDropDown(item)\">\n        <ngx-dropdown\n          *ngFor=\"let dropdownItem of getDropdownItems(item) | keyvalue; trackBy: trackByIndex\"\n          [class]=\"dropdownContainerClass\"\n          [group]=\"dropdownItem.key\"\n          [items]=\"dropdownItem.value\"\n        >\n        </ngx-dropdown>\n      </ng-container>\n\n      <!-- text color picker -->\n      <ngx-color-picker\n        [class]=\"iconContainerClass\"\n        *ngIf=\"item === 'text_color'\"\n        type=\"text_color\"\n        [presets]=\"presets\"\n      >\n      </ngx-color-picker>\n      <!-- background color picker -->\n      <ngx-color-picker\n        [class]=\"iconContainerClass\"\n        *ngIf=\"item === 'background_color'\"\n        type=\"background_color\"\n        [presets]=\"presets\"\n      >\n      </ngx-color-picker>\n\n      <!-- seperator -->\n      <div [class]=\"seperatorClass\" *ngIf=\"lastItem && !lastToolbarItem\"></div>\n    </ng-container>\n  </ng-container>\n\n  <!-- custom menu -->\n  <ng-container *ngIf=\"customMenuRef\">\n    <ng-container [ngTemplateOutlet]=\"customMenuRef\"></ng-container>\n  </ng-container>\n</div>\n" }]
        }], ctorParameters: () => [{ type: i1.MenuService }], propDecorators: { toolbar: [{
                type: Input
            }], colorPresets: [{
                type: Input
            }], disabled: [{
                type: Input
            }], editor: [{
                type: Input
            }], customMenuRef: [{
                type: Input
            }], dropdownPlacement: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVudS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9uZ3gtZWRpdG9yL3NyYy9saWIvbW9kdWxlcy9tZW51L21lbnUuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbmd4LWVkaXRvci9zcmMvbGliL21vZHVsZXMvbWVudS9tZW51LmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFDTCxTQUFTLEVBQUUsS0FBSyxHQUVqQixNQUFNLGVBQWUsQ0FBQztBQUV2QixPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFFbEQsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGdCQUFnQixDQUFDOzs7Ozs7Ozs7O0FBRzdDLE1BQU0sQ0FBQyxNQUFNLGVBQWUsR0FBWTtJQUN0QyxDQUFDLE1BQU0sRUFBRSxRQUFRLENBQUM7SUFDbEIsQ0FBQyxNQUFNLEVBQUUsWUFBWSxDQUFDO0lBQ3RCLENBQUMsV0FBVyxFQUFFLFFBQVEsQ0FBQztJQUN2QixDQUFDLGNBQWMsRUFBRSxhQUFhLENBQUM7SUFDL0IsQ0FBQyxFQUFFLE9BQU8sRUFBRSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQztJQUNuRCxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUM7SUFDakIsQ0FBQyxZQUFZLEVBQUUsa0JBQWtCLENBQUM7SUFDbEMsQ0FBQyxZQUFZLEVBQUUsY0FBYyxFQUFFLGFBQWEsRUFBRSxlQUFlLENBQUM7SUFDOUQsQ0FBQyxjQUFjLENBQUM7Q0FDakIsQ0FBQztBQUVGLE1BQU0sQ0FBQyxNQUFNLGVBQWUsR0FBWTtJQUN0QyxDQUFDLE1BQU0sRUFBRSxRQUFRLENBQUM7SUFDbEIsQ0FBQyxFQUFFLE9BQU8sRUFBRSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQztJQUNuRCxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUM7SUFDakIsQ0FBQyxZQUFZLEVBQUUsa0JBQWtCLENBQUM7Q0FDbkMsQ0FBQztBQUVGLE1BQU0sQ0FBQyxNQUFNLFlBQVksR0FBWTtJQUNuQyxDQUFDLE1BQU0sRUFBRSxRQUFRLENBQUM7SUFDbEIsQ0FBQyxNQUFNLEVBQUUsWUFBWSxDQUFDO0lBQ3RCLENBQUMsV0FBVyxFQUFFLFFBQVEsQ0FBQztJQUN2QixDQUFDLGNBQWMsRUFBRSxhQUFhLENBQUM7SUFDL0IsQ0FBQyxFQUFFLE9BQU8sRUFBRSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQztJQUNuRCxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUM7SUFDakIsQ0FBQyxZQUFZLEVBQUUsa0JBQWtCLENBQUM7SUFDbEMsQ0FBQyxZQUFZLEVBQUUsY0FBYyxFQUFFLGFBQWEsRUFBRSxlQUFlLENBQUM7SUFDOUQsQ0FBQyxpQkFBaUIsRUFBRSxjQUFjLEVBQUUsUUFBUSxFQUFFLFNBQVMsQ0FBQztJQUN4RCxDQUFDLGFBQWEsRUFBRSxXQUFXLENBQUM7SUFDNUIsQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDO0NBQ2pCLENBQUM7QUFFRixNQUFNLHFCQUFxQixHQUFHO0lBQzVCLFNBQVM7SUFDVCxTQUFTO0lBQ1QsU0FBUztJQUNULFNBQVM7SUFDVCxTQUFTO0lBQ1QsU0FBUztJQUNULFNBQVM7SUFDVCxTQUFTO0lBQ1QsU0FBUztJQUNULFNBQVM7SUFDVCxTQUFTO0lBQ1QsU0FBUztJQUNULFNBQVM7SUFDVCxTQUFTO0lBQ1QsU0FBUztJQUNULFNBQVM7Q0FDVixDQUFDO0FBU0YsTUFBTSxPQUFPLGFBQWE7SUFzQ0o7SUFyQ1gsT0FBTyxHQUFZLGVBQWUsQ0FBQztJQUNuQyxZQUFZLEdBQWEscUJBQXFCLENBQUM7SUFDL0MsUUFBUSxHQUFHLEtBQUssQ0FBQztJQUNqQixNQUFNLENBQVM7SUFDZixhQUFhLEdBQTRCLElBQUksQ0FBQztJQUM5QyxpQkFBaUIsR0FBcUIsUUFBUSxDQUFDO0lBRXhELGNBQWMsR0FBa0I7UUFDOUIsTUFBTTtRQUNOLFFBQVE7UUFDUixXQUFXO1FBQ1gsUUFBUTtRQUNSLE1BQU07UUFDTixZQUFZO1FBQ1osY0FBYztRQUNkLGFBQWE7UUFDYixZQUFZO1FBQ1osY0FBYztRQUNkLGFBQWE7UUFDYixlQUFlO1FBQ2YsYUFBYTtRQUNiLFdBQVc7S0FDWixDQUFDO0lBRUYsY0FBYyxHQUFrQjtRQUM5QixpQkFBaUI7UUFDakIsY0FBYztRQUNkLFFBQVE7UUFDUixTQUFTO1FBQ1QsTUFBTTtRQUNOLE1BQU07S0FDUCxDQUFDO0lBRUYsa0JBQWtCLEdBQUcsQ0FBQyxxQkFBcUIsRUFBRSxvQ0FBb0MsQ0FBQyxDQUFDO0lBQ25GLHNCQUFzQixHQUFHLENBQUMscUJBQXFCLENBQUMsQ0FBQztJQUNqRCxjQUFjLEdBQUcsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO0lBRTFDLFlBQW9CLFdBQXdCO1FBQXhCLGdCQUFXLEdBQVgsV0FBVyxDQUFhO0lBQUksQ0FBQztJQUVqRCxJQUFJLE9BQU87UUFDVCxNQUFNLEdBQUcsR0FBRyxDQUFDLENBQUM7UUFDZCxNQUFNLE1BQU0sR0FBZSxFQUFFLENBQUM7UUFFOUIsSUFBSSxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQUU7WUFDekMsTUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLEdBQUcsR0FBRyxDQUFDLENBQUM7WUFFcEMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDO2dCQUNqQixNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQ2xCLENBQUM7WUFFRCxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzFCLENBQUMsQ0FBQyxDQUFDO1FBRUgsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQztJQUVELFlBQVksQ0FBQyxLQUFhO1FBQ3hCLE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQztJQUVELFVBQVUsQ0FBQyxJQUFpQjtRQUMxQixJQUFLLElBQXdCLEVBQUUsT0FBTyxFQUFFLENBQUM7WUFDdkMsT0FBTyxJQUFJLENBQUM7UUFDZCxDQUFDO1FBRUQsT0FBTyxLQUFLLENBQUM7SUFDZixDQUFDO0lBRUQsZ0JBQWdCLENBQUMsSUFBaUI7UUFDaEMsT0FBTyxJQUF1QixDQUFDO0lBQ2pDLENBQUM7SUFFRCxVQUFVLENBQUMsSUFBaUI7UUFDMUIsSUFBSSxJQUFJLEtBQUssTUFBTSxFQUFFLENBQUM7WUFDcEIsT0FBTyxJQUFJLENBQUM7UUFDZCxDQUFDO1FBRUQsNERBQTREO1FBQzVELG1FQUFtRTtRQUNuRSxPQUFPLE9BQU8sSUFBSSxLQUFLLFFBQVE7ZUFDMUIsT0FBUSxJQUFvQixFQUFFLElBQUksS0FBSyxRQUFRLENBQUM7SUFDdkQsQ0FBQztJQUVELGlCQUFpQixDQUFDLElBQWlCO1FBQ2pDLDREQUE0RDtRQUM1RCxtRUFBbUU7UUFDbkUsT0FBTyxPQUFPLElBQUksS0FBSyxRQUFRO2VBQzFCLE9BQVEsSUFBb0IsRUFBRSxJQUFJLEtBQUssUUFBUSxDQUFDO0lBQ3ZELENBQUM7SUFFRCxjQUFjLENBQUMsSUFBaUI7UUFDOUIsT0FBUSxJQUFvQixFQUFFLElBQUksQ0FBQztJQUNyQyxDQUFDO0lBRUQsUUFBUTtRQUNOLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDakIsTUFBTSxJQUFJLGNBQWMsQ0FBQyx1REFBdUQsQ0FBQyxDQUFDO1FBQ3BGLENBQUM7UUFFRCxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDO0lBQ3hDLENBQUM7dUdBckdVLGFBQWE7MkZBQWIsYUFBYSx3TkFIYixDQUFDLFdBQVcsQ0FBQywwQkNsRTFCLHNwRUEyREE7OzJGRFVhLGFBQWE7a0JBUHpCLFNBQVM7K0JBQ0UsaUJBQWlCLGFBR2hCLENBQUMsV0FBVyxDQUFDO2dGQUlmLE9BQU87c0JBQWYsS0FBSztnQkFDRyxZQUFZO3NCQUFwQixLQUFLO2dCQUNHLFFBQVE7c0JBQWhCLEtBQUs7Z0JBQ0csTUFBTTtzQkFBZCxLQUFLO2dCQUNHLGFBQWE7c0JBQXJCLEtBQUs7Z0JBQ0csaUJBQWlCO3NCQUF6QixLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQ29tcG9uZW50LCBJbnB1dCxcbiAgT25Jbml0LCBUZW1wbGF0ZVJlZixcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IE5neEVkaXRvckVycm9yIH0gZnJvbSAnbmd4LWVkaXRvci91dGlscyc7XG5pbXBvcnQgeyBUb29sYmFyLCBUb29sYmFySXRlbSwgVG9vbGJhckRyb3Bkb3duLCBUb29sYmFyTGluaywgVG9vbGJhckxpbmtPcHRpb25zIH0gZnJvbSAnLi4vLi4vdHlwZXMnO1xuaW1wb3J0IHsgTWVudVNlcnZpY2UgfSBmcm9tICcuL21lbnUuc2VydmljZSc7XG5pbXBvcnQgRWRpdG9yIGZyb20gJy4uLy4uL0VkaXRvcic7XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1RPT0xCQVI6IFRvb2xiYXIgPSBbXG4gIFsnYm9sZCcsICdpdGFsaWMnXSxcbiAgWydjb2RlJywgJ2Jsb2NrcXVvdGUnXSxcbiAgWyd1bmRlcmxpbmUnLCAnc3RyaWtlJ10sXG4gIFsnb3JkZXJlZF9saXN0JywgJ2J1bGxldF9saXN0J10sXG4gIFt7IGhlYWRpbmc6IFsnaDEnLCAnaDInLCAnaDMnLCAnaDQnLCAnaDUnLCAnaDYnXSB9XSxcbiAgWydsaW5rJywgJ2ltYWdlJ10sXG4gIFsndGV4dF9jb2xvcicsICdiYWNrZ3JvdW5kX2NvbG9yJ10sXG4gIFsnYWxpZ25fbGVmdCcsICdhbGlnbl9jZW50ZXInLCAnYWxpZ25fcmlnaHQnLCAnYWxpZ25fanVzdGlmeSddLFxuICBbJ2Zvcm1hdF9jbGVhciddLFxuXTtcblxuZXhwb3J0IGNvbnN0IFRPT0xCQVJfTUlOSU1BTDogVG9vbGJhciA9IFtcbiAgWydib2xkJywgJ2l0YWxpYyddLFxuICBbeyBoZWFkaW5nOiBbJ2gxJywgJ2gyJywgJ2gzJywgJ2g0JywgJ2g1JywgJ2g2J10gfV0sXG4gIFsnbGluaycsICdpbWFnZSddLFxuICBbJ3RleHRfY29sb3InLCAnYmFja2dyb3VuZF9jb2xvciddLFxuXTtcblxuZXhwb3J0IGNvbnN0IFRPT0xCQVJfRlVMTDogVG9vbGJhciA9IFtcbiAgWydib2xkJywgJ2l0YWxpYyddLFxuICBbJ2NvZGUnLCAnYmxvY2txdW90ZSddLFxuICBbJ3VuZGVybGluZScsICdzdHJpa2UnXSxcbiAgWydvcmRlcmVkX2xpc3QnLCAnYnVsbGV0X2xpc3QnXSxcbiAgW3sgaGVhZGluZzogWydoMScsICdoMicsICdoMycsICdoNCcsICdoNScsICdoNiddIH1dLFxuICBbJ2xpbmsnLCAnaW1hZ2UnXSxcbiAgWyd0ZXh0X2NvbG9yJywgJ2JhY2tncm91bmRfY29sb3InXSxcbiAgWydhbGlnbl9sZWZ0JywgJ2FsaWduX2NlbnRlcicsICdhbGlnbl9yaWdodCcsICdhbGlnbl9qdXN0aWZ5J10sXG4gIFsnaG9yaXpvbnRhbF9ydWxlJywgJ2Zvcm1hdF9jbGVhcicsICdpbmRlbnQnLCAnb3V0ZGVudCddLFxuICBbJ3N1cGVyc2NyaXB0JywgJ3N1YnNjcmlwdCddLFxuICBbJ3VuZG8nLCAncmVkbyddLFxuXTtcblxuY29uc3QgREVGQVVMVF9DT0xPUl9QUkVTRVRTID0gW1xuICAnI2I2MDIwNScsXG4gICcjZDkzZjBiJyxcbiAgJyNmYmNhMDQnLFxuICAnIzBlOGExNicsXG4gICcjMDA2Yjc1JyxcbiAgJyMxZDc2ZGInLFxuICAnIzAwNTJjYycsXG4gICcjNTMxOWU3JyxcbiAgJyNlOTk2OTUnLFxuICAnI2Y5ZDBjNCcsXG4gICcjZmVmMmMwJyxcbiAgJyNjMmUwYzYnLFxuICAnI2JmZGFkYycsXG4gICcjYzVkZWY1JyxcbiAgJyNiZmQ0ZjInLFxuICAnI2Q0YzVmOScsXG5dO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICduZ3gtZWRpdG9yLW1lbnUnLFxuICB0ZW1wbGF0ZVVybDogJy4vbWVudS5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL21lbnUuY29tcG9uZW50LnNjc3MnXSxcbiAgcHJvdmlkZXJzOiBbTWVudVNlcnZpY2VdLFxufSlcblxuZXhwb3J0IGNsYXNzIE1lbnVDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuICBASW5wdXQoKSB0b29sYmFyOiBUb29sYmFyID0gVE9PTEJBUl9NSU5JTUFMO1xuICBASW5wdXQoKSBjb2xvclByZXNldHM6IHN0cmluZ1tdID0gREVGQVVMVF9DT0xPUl9QUkVTRVRTO1xuICBASW5wdXQoKSBkaXNhYmxlZCA9IGZhbHNlO1xuICBASW5wdXQoKSBlZGl0b3I6IEVkaXRvcjtcbiAgQElucHV0KCkgY3VzdG9tTWVudVJlZjogVGVtcGxhdGVSZWY8YW55PiB8IG51bGwgPSBudWxsO1xuICBASW5wdXQoKSBkcm9wZG93blBsYWNlbWVudDogJ3RvcCcgfCAnYm90dG9tJyA9ICdib3R0b20nO1xuXG4gIHRvZ2dsZUNvbW1hbmRzOiBUb29sYmFySXRlbVtdID0gW1xuICAgICdib2xkJyxcbiAgICAnaXRhbGljJyxcbiAgICAndW5kZXJsaW5lJyxcbiAgICAnc3RyaWtlJyxcbiAgICAnY29kZScsXG4gICAgJ2Jsb2NrcXVvdGUnLFxuICAgICdvcmRlcmVkX2xpc3QnLFxuICAgICdidWxsZXRfbGlzdCcsXG4gICAgJ2FsaWduX2xlZnQnLFxuICAgICdhbGlnbl9jZW50ZXInLFxuICAgICdhbGlnbl9yaWdodCcsXG4gICAgJ2FsaWduX2p1c3RpZnknLFxuICAgICdzdXBlcnNjcmlwdCcsXG4gICAgJ3N1YnNjcmlwdCcsXG4gIF07XG5cbiAgaW5zZXJ0Q29tbWFuZHM6IFRvb2xiYXJJdGVtW10gPSBbXG4gICAgJ2hvcml6b250YWxfcnVsZScsXG4gICAgJ2Zvcm1hdF9jbGVhcicsXG4gICAgJ2luZGVudCcsXG4gICAgJ291dGRlbnQnLFxuICAgICd1bmRvJyxcbiAgICAncmVkbycsXG4gIF07XG5cbiAgaWNvbkNvbnRhaW5lckNsYXNzID0gWydOZ3hFZGl0b3JfX01lbnVJdGVtJywgJ05neEVkaXRvcl9fTWVudUl0ZW0tLUljb25Db250YWluZXInXTtcbiAgZHJvcGRvd25Db250YWluZXJDbGFzcyA9IFsnTmd4RWRpdG9yX19Ecm9wZG93biddO1xuICBzZXBlcmF0b3JDbGFzcyA9IFsnTmd4RWRpdG9yX19TZXBlcmF0b3InXTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIG1lbnVTZXJ2aWNlOiBNZW51U2VydmljZSkgeyB9XG5cbiAgZ2V0IHByZXNldHMoKTogc3RyaW5nW11bXSB7XG4gICAgY29uc3QgY29sID0gODtcbiAgICBjb25zdCBjb2xvcnM6IHN0cmluZ1tdW10gPSBbXTtcblxuICAgIHRoaXMuY29sb3JQcmVzZXRzLmZvckVhY2goKGNvbG9yLCBpbmRleCkgPT4ge1xuICAgICAgY29uc3Qgcm93ID0gTWF0aC5mbG9vcihpbmRleCAvIGNvbCk7XG5cbiAgICAgIGlmICghY29sb3JzW3Jvd10pIHtcbiAgICAgICAgY29sb3JzLnB1c2goW10pO1xuICAgICAgfVxuXG4gICAgICBjb2xvcnNbcm93XS5wdXNoKGNvbG9yKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBjb2xvcnM7XG4gIH1cblxuICB0cmFja0J5SW5kZXgoaW5kZXg6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIGluZGV4O1xuICB9XG5cbiAgaXNEcm9wRG93bihpdGVtOiBUb29sYmFySXRlbSk6IGJvb2xlYW4ge1xuICAgIGlmICgoaXRlbSBhcyBUb29sYmFyRHJvcGRvd24pPy5oZWFkaW5nKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBnZXREcm9wZG93bkl0ZW1zKGl0ZW06IFRvb2xiYXJJdGVtKTogVG9vbGJhckRyb3Bkb3duIHtcbiAgICByZXR1cm4gaXRlbSBhcyBUb29sYmFyRHJvcGRvd247XG4gIH1cblxuICBpc0xpbmtJdGVtKGl0ZW06IFRvb2xiYXJJdGVtKTogYm9vbGVhbiB7XG4gICAgaWYgKGl0ZW0gPT09ICdsaW5rJykge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLy8gTk9URTogaXQgaXMgbm90IHN1ZmZpY2llbnQgdG8gY2hlY2sgZm9yIGEgYGxpbmtgIHByb3BlcnR5XG4gICAgLy8gYXMgU3RyaW5nLnByb3RvdHlwZS5saW5rIGlzIGEgdmFsaWQgKGFsdGhvdWdoIGRlcHJlY2F0ZWQpIG1ldGhvZFxuICAgIHJldHVybiB0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCdcbiAgICAgICYmIHR5cGVvZiAoaXRlbSBhcyBUb29sYmFyTGluayk/LmxpbmsgPT09ICdvYmplY3QnO1xuICB9XG5cbiAgaXNMaW5rV2l0aE9wdGlvbnMoaXRlbTogVG9vbGJhckl0ZW0pOiBib29sZWFuIHtcbiAgICAvLyBOT1RFOiBpdCBpcyBub3Qgc3VmZmljaWVudCB0byBjaGVjayBmb3IgYSBgbGlua2AgcHJvcGVydHlcbiAgICAvLyBhcyBTdHJpbmcucHJvdG90eXBlLmxpbmsgaXMgYSB2YWxpZCAoYWx0aG91Z2ggZGVwcmVjYXRlZCkgbWV0aG9kXG4gICAgcmV0dXJuIHR5cGVvZiBpdGVtID09PSAnb2JqZWN0J1xuICAgICAgJiYgdHlwZW9mIChpdGVtIGFzIFRvb2xiYXJMaW5rKT8ubGluayA9PT0gJ29iamVjdCc7XG4gIH1cblxuICBnZXRMaW5rT3B0aW9ucyhpdGVtOiBUb29sYmFySXRlbSk6IFBhcnRpYWw8VG9vbGJhckxpbmtPcHRpb25zPiB7XG4gICAgcmV0dXJuIChpdGVtIGFzIFRvb2xiYXJMaW5rKT8ubGluaztcbiAgfVxuXG4gIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5lZGl0b3IpIHtcbiAgICAgIHRocm93IG5ldyBOZ3hFZGl0b3JFcnJvcignUmVxdWlyZWQgZWRpdG9yIGluc3RhbmNlIHRvIGluaXRpYWxpemUgbWVudSBjb21wb25lbnQnKTtcbiAgICB9XG5cbiAgICB0aGlzLm1lbnVTZXJ2aWNlLmVkaXRvciA9IHRoaXMuZWRpdG9yO1xuICB9XG59XG4iLCI8ZGl2XG4gIGNsYXNzPVwiTmd4RWRpdG9yX19NZW51QmFyXCJcbiAgW25nQ2xhc3NdPVwieyAnTmd4RWRpdG9yLS1EaXNhYmxlZCc6IGRpc2FibGVkLCAnTmd4RWRpdG9yX19NZW51QmFyLS1SZXZlcnNlJzogZHJvcGRvd25QbGFjZW1lbnQgPT09ICd0b3AnIH1cIlxuPlxuICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCB0b29sYmFySXRlbSBvZiB0b29sYmFyOyBsZXQgbGFzdFRvb2xiYXJJdGVtID0gbGFzdDsgdHJhY2tCeTogdHJhY2tCeUluZGV4XCI+XG4gICAgPG5nLWNvbnRhaW5lciAqbmdGb3I9XCJsZXQgaXRlbSBvZiB0b29sYmFySXRlbTsgbGV0IGxhc3RJdGVtID0gbGFzdDsgdHJhY2tCeTogdHJhY2tCeUluZGV4XCI+XG4gICAgICA8IS0tIHRvZ2dsZSBpY29ucyAtLT5cbiAgICAgIDxuZ3gtdG9nZ2xlLWNvbW1hbmQgW3Rvb2xiYXJJdGVtXT1cIml0ZW1cIiBbY2xhc3NdPVwiaWNvbkNvbnRhaW5lckNsYXNzXCIgKm5nSWY9XCJ0b2dnbGVDb21tYW5kcy5pbmNsdWRlcyhpdGVtKVwiPlxuICAgICAgPC9uZ3gtdG9nZ2xlLWNvbW1hbmQ+XG5cbiAgICAgIDxuZ3gtaW5zZXJ0LWNvbW1hbmQgW3Rvb2xiYXJJdGVtXT1cIml0ZW1cIiBbY2xhc3NdPVwiaWNvbkNvbnRhaW5lckNsYXNzXCIgKm5nSWY9XCJpbnNlcnRDb21tYW5kcy5pbmNsdWRlcyhpdGVtKVwiPlxuICAgICAgPC9uZ3gtaW5zZXJ0LWNvbW1hbmQ+XG5cbiAgICAgIDwhLS0gbGluayAtLT5cbiAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJpc0xpbmtJdGVtKGl0ZW0pXCI+XG4gICAgICAgIDxuZ3gtbGluayBbY2xhc3NdPVwiaWNvbkNvbnRhaW5lckNsYXNzXCIgW29wdGlvbnNdPVwiZ2V0TGlua09wdGlvbnMoaXRlbSlcIj48L25neC1saW5rPlxuICAgICAgPC9uZy1jb250YWluZXI+XG5cbiAgICAgIDwhLS0gaW1hZ2UgLS0+XG4gICAgICA8bmd4LWltYWdlIFtjbGFzc109XCJpY29uQ29udGFpbmVyQ2xhc3NcIiAqbmdJZj1cIml0ZW0gPT09ICdpbWFnZSdcIj4gPC9uZ3gtaW1hZ2U+XG5cbiAgICAgIDwhLS0gZHJvcGRvd24gLS0+XG4gICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiaXNEcm9wRG93bihpdGVtKVwiPlxuICAgICAgICA8bmd4LWRyb3Bkb3duXG4gICAgICAgICAgKm5nRm9yPVwibGV0IGRyb3Bkb3duSXRlbSBvZiBnZXREcm9wZG93bkl0ZW1zKGl0ZW0pIHwga2V5dmFsdWU7IHRyYWNrQnk6IHRyYWNrQnlJbmRleFwiXG4gICAgICAgICAgW2NsYXNzXT1cImRyb3Bkb3duQ29udGFpbmVyQ2xhc3NcIlxuICAgICAgICAgIFtncm91cF09XCJkcm9wZG93bkl0ZW0ua2V5XCJcbiAgICAgICAgICBbaXRlbXNdPVwiZHJvcGRvd25JdGVtLnZhbHVlXCJcbiAgICAgICAgPlxuICAgICAgICA8L25neC1kcm9wZG93bj5cbiAgICAgIDwvbmctY29udGFpbmVyPlxuXG4gICAgICA8IS0tIHRleHQgY29sb3IgcGlja2VyIC0tPlxuICAgICAgPG5neC1jb2xvci1waWNrZXJcbiAgICAgICAgW2NsYXNzXT1cImljb25Db250YWluZXJDbGFzc1wiXG4gICAgICAgICpuZ0lmPVwiaXRlbSA9PT0gJ3RleHRfY29sb3InXCJcbiAgICAgICAgdHlwZT1cInRleHRfY29sb3JcIlxuICAgICAgICBbcHJlc2V0c109XCJwcmVzZXRzXCJcbiAgICAgID5cbiAgICAgIDwvbmd4LWNvbG9yLXBpY2tlcj5cbiAgICAgIDwhLS0gYmFja2dyb3VuZCBjb2xvciBwaWNrZXIgLS0+XG4gICAgICA8bmd4LWNvbG9yLXBpY2tlclxuICAgICAgICBbY2xhc3NdPVwiaWNvbkNvbnRhaW5lckNsYXNzXCJcbiAgICAgICAgKm5nSWY9XCJpdGVtID09PSAnYmFja2dyb3VuZF9jb2xvcidcIlxuICAgICAgICB0eXBlPVwiYmFja2dyb3VuZF9jb2xvclwiXG4gICAgICAgIFtwcmVzZXRzXT1cInByZXNldHNcIlxuICAgICAgPlxuICAgICAgPC9uZ3gtY29sb3ItcGlja2VyPlxuXG4gICAgICA8IS0tIHNlcGVyYXRvciAtLT5cbiAgICAgIDxkaXYgW2NsYXNzXT1cInNlcGVyYXRvckNsYXNzXCIgKm5nSWY9XCJsYXN0SXRlbSAmJiAhbGFzdFRvb2xiYXJJdGVtXCI+PC9kaXY+XG4gICAgPC9uZy1jb250YWluZXI+XG4gIDwvbmctY29udGFpbmVyPlxuXG4gIDwhLS0gY3VzdG9tIG1lbnUgLS0+XG4gIDxuZy1jb250YWluZXIgKm5nSWY9XCJjdXN0b21NZW51UmVmXCI+XG4gICAgPG5nLWNvbnRhaW5lciBbbmdUZW1wbGF0ZU91dGxldF09XCJjdXN0b21NZW51UmVmXCI+PC9uZy1jb250YWluZXI+XG4gIDwvbmctY29udGFpbmVyPlxuPC9kaXY+XG4iXX0=